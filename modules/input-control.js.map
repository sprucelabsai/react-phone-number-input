{"version":3,"sources":["../source/input-control.js"],"names":["getPreSelectedCountry","getCountrySelectOptions","parsePhoneNumber","generateNationalNumberDigits","migrateParsedInputForNewCountry","e164","trimNumber","getCountryForPartialE164Number","parseInput","get_country_from_possibly_incomplete_international_phone_number","compare_strings","strip_country_calling_code","get_national_significant_number_part","could_number_belong_to_country","phoneNumber","country","countries","includeInternationalOption","metadata","indexOf","undefined","length","country_names","country_select_options","map","value","label","sort","a","b","unshift","ZZ","formatNational","replace","previous_country","new_country","preferNationalFormat","slice","number","partial_national_significant_number","nationalSignificantNumberPart","overflowDigitsCount","getMaxNumberLength","possibleLengths","partialE164Number","derived_country","input","prevInput","limitMaxLength","formatter","String","prototype","localeCompare","country_calling_prefix","Object","keys","country_calling_codes","country_calling_code","getNationalNumber","i"],"mappings":"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","file":"input-control.js","sourcesContent":["import {\n\tparsePhoneNumberFromString,\n\tgetCountryCallingCode,\n\tAsYouType,\n\tMetadata\n} from 'libphonenumber-js/core'\n\n/**\n * Decides which country should be pre-selected\n * when the phone number input component is first mounted.\n * @param  {object?} phoneNumber - An instance of `PhoneNumber` class.\n * @param  {string?} country - Pre-defined country (two-letter code).\n * @param  {string[]?} countries - A list of countries available.\n * @param  {boolean} includeInternationalOption - Whether \"International\" country option is available.\n * @param  {object} metadata - `libphonenumber-js` metadata\n * @return {string?}\n */\nexport function getPreSelectedCountry(phoneNumber, country, countries, includeInternationalOption, metadata)\n{\n\t// If can get country from E.164 phone number\n\t// then it overrides the `country` passed (or not passed).\n\tif (phoneNumber && phoneNumber.country)\n\t{\n\t\t// `country` will be left `undefined` in case of non-detection.\n\t\tcountry = phoneNumber.country\n\t}\n\n\t// Only pre-select a country if it's in the available `countries` list.\n\tif (countries && countries.indexOf(country) < 0)\n\t{\n\t\tcountry = undefined\n\t}\n\n\t// If there will be no \"International\" option\n\t// then some `country` must be selected.\n\t// It will still be the wrong country though.\n\t// But still country `<select/>` can't be left in a broken state.\n\tif (!country && !includeInternationalOption && countries && countries.length > 0)\n\t{\n\t\tcountry = countries[0]\n\t}\n\n\treturn country\n}\n\n/**\n * Generates a sorted list of country `<select/>` options.\n * @param  {string[]} countries - A list of two-letter (\"ISO 3166-1 alpha-2\") country codes.\n * @param  {object} labels - Custom country labels. E.g. `{ RU: 'Россия', US: 'США', ... }`.\n * @param  {boolean} includeInternationalOption - Whether should include \"International\" option at the top of the list.\n * @return {object[]} A list of objects having shape `{ value : string, label : string }`.\n */\nexport function getCountrySelectOptions(countries, country_names, includeInternationalOption)\n{\n\t// Generates a `<Select/>` option for each country.\n\tconst country_select_options = countries.map((country) =>\n\t({\n\t\tvalue : country,\n\t\tlabel : country_names[country]\n\t}))\n\n\t// Sort the list of countries alphabetically.\n\tcountry_select_options.sort((a, b) => compare_strings(a.label, b.label))\n\n\t// Add the \"International\" option to the country list (if suitable)\n\tif (includeInternationalOption)\n\t{\n\t\tcountry_select_options.unshift\n\t\t({\n\t\t\tlabel : country_names.ZZ\n\t\t})\n\t}\n\n\treturn country_select_options\n}\n\n/**\n * Parses a E.164 phone number to an instance of `PhoneNumber` class.\n * @param {string?} value = E.164 phone number.\n * @param  {object} metadata - `libphonenumber-js` metadata\n * @example\n * parsePhoneNumber('+78005553535')\n */\nexport function parsePhoneNumber(value, metadata)\n{\n\treturn parsePhoneNumberFromString(value || '', metadata)\n}\n\n/**\n * Generates national number digits for a parsed phone.\n * May prepend national prefix.\n * The phone number must be a complete and valid phone number.\n * @param  {object} phoneNumber - An instance of `PhoneNumber` class.\n * @param  {object} metadata - `libphonenumber-js` metadata\n * @return {string}\n * @example\n * getNationalNumberDigits({ country: 'RU', phone: '8005553535' })\n * // returns '88005553535'\n */\nexport function generateNationalNumberDigits(phoneNumber)\n{\n\treturn phoneNumber.formatNational().replace(/\\D/g, '')\n}\n\n/**\n * Migrates parsed `<input/>` `value` for the newly selected `country`.\n * @param {string?} value - The `value` parsed from phone number `<input/>` (it's the `parsed_input` state property, not the `value` property).\n * @param {string?} previousCountry - Previously selected country.\n * @param {string?} newCountry - Newly selected country. Can't be same as previously selected country.\n * @param {object} metadata - `libphonenumber-js` metadata.\n * @param {boolean} preferNationalFormat - whether should attempt to convert from international to national number for the new country.\n * @return {string?}\n */\nexport function migrateParsedInputForNewCountry\n(\n\tvalue,\n\tprevious_country,\n\tnew_country,\n\tmetadata,\n\tpreferNationalFormat\n)\n{\n\t// If `parsed_input` is empty\n\t// then no need to migrate anything.\n\tif (!value) {\n\t\treturn value\n\t}\n\n\t// If switching to some country.\n\t// (from \"International\" or another country)\n\t// If switching from \"International\" then `value` starts with a `+`.\n\t// Otherwise it may or may not start with a `+`.\n\tif (new_country)\n\t{\n\t\t// If the phone number was entered in international format\n\t\t// then migrate it to the newly selected country.\n\t\t// The phone number may be incomplete.\n\t\t// The phone number entered not necessarily starts with\n\t\t// the previously selected country phone prefix.\n\t\tif (value[0] === '+')\n\t\t{\n\t\t\t// If the international phone number is for the new country\n\t\t\t// then convert it to local if required.\n\t\t\tif (preferNationalFormat)\n\t\t\t{\n\t\t\t\t// // If a phone number is being input in international form\n\t\t\t\t// // and the country can already be derived from it,\n\t\t\t\t// // and if it is the new country, then format as a national number.\n\t\t\t\t// const derived_country = get_country_from_possibly_incomplete_international_phone_number(value, metadata)\n\t\t\t\t// if (derived_country === new_country)\n\t\t\t\t// {\n\t\t\t\t// \treturn strip_country_calling_code(value, derived_country, metadata)\n\t\t\t\t// }\n\n\t\t\t\t// Simply strip the leading `+` character\n\t\t\t\t// therefore simply converting all digits into a \"local\" phone number.\n\t\t\t\t// https://github.com/catamphetamine/react-phone-number-input/issues/287\n\t\t\t\treturn value.slice(1)\n\t\t\t}\n\n\t\t\t// If the international phone number already contains\n\t\t\t// any country calling code then trim the country calling code part.\n\t\t\t// (that could also be the newly selected country phone code prefix as well)\n\t\t\t// `value` doesn't neccessarily belong to `previous_country`.\n\t\t\t// (e.g. if a user enters an international number\n\t\t\t//  not belonging to any of the reduced `countries` list).\n\t\t\tvalue = strip_country_calling_code(value, previous_country, metadata)\n\n\t\t\t// Prepend country calling code prefix\n\t\t\t// for the newly selected country.\n\t\t\treturn e164(value, new_country, metadata) || `+${getCountryCallingCode(new_country, metadata)}`\n\t\t}\n\t}\n\t// If switching to \"International\" from a country.\n\telse\n\t{\n\t\t// If the phone number was entered in national format.\n\t\tif (value[0] !== '+')\n\t\t{\n\t\t\t// Format the national phone number as an international one.\n\t\t\t// The phone number entered not necessarily even starts with\n\t\t\t// the previously selected country phone prefix.\n\t\t\t// Even if the phone number belongs to whole another country\n\t\t\t// it will still be parsed into some national phone number.\n\t\t\treturn e164(value, previous_country, metadata) || ''\n\t\t}\n\t}\n\n\treturn value\n}\n\n/**\n * Converts phone number digits to a (possibly incomplete) E.164 phone number.\n * @param  {string?} number - A possibly incomplete phone number digits string. Can be a possibly incomplete E.164 phone number.\n * @param  {string?} country\n * @param  {[object} metadata - `libphonenumber-js` metadata.\n * @return {string?}\n */\nexport function e164(number, country, metadata)\n{\n\tif (!number) {\n\t\treturn\n\t}\n\n\t// If the phone number is being input in international format.\n\tif (number[0] === '+')\n\t{\n\t\t// If it's just the `+` sign then return nothing.\n\t\tif (number === '+') {\n\t\t\treturn\n\t\t}\n\n\t\t// If there are any digits then the `value` is returned as is.\n\t\treturn number\n\t}\n\n\t// For non-international phone numbers\n\t// an accompanying country code is required.\n\tif (!country) {\n\t\treturn\n\t}\n\n\tconst partial_national_significant_number = get_national_significant_number_part(number, country, metadata)\n\n\tif (partial_national_significant_number) {\n\t\treturn `+${getCountryCallingCode(country, metadata)}${partial_national_significant_number}`\n\t}\n}\n\n/**\n * Trims phone number digits if they exceed the maximum possible length\n * for a national (significant) number for the country.\n * @param  {string} number - A possibly incomplete phone number digits string. Can be a possibly incomplete E.164 phone number.\n * @param  {string} country\n * @param  {object} metadata - `libphonenumber-js` metadata.\n * @return {string} Can be empty.\n */\nexport function trimNumber(number, country, metadata)\n{\n\tconst nationalSignificantNumberPart = get_national_significant_number_part(number, country, metadata)\n\tconst overflowDigitsCount = nationalSignificantNumberPart.length - getMaxNumberLength(country, metadata)\n\tif (overflowDigitsCount > 0) {\n\t\treturn number.slice(0, number.length - overflowDigitsCount)\n\t}\n\treturn number\n}\n\nfunction getMaxNumberLength(country, metadata)\n{\n\t// Get \"possible lengths\" for a phone number of the country.\n\tmetadata = new Metadata(metadata)\n\tmetadata.country(country)\n\t// Return the last \"possible length\".\n\treturn metadata.possibleLengths()[metadata.possibleLengths().length - 1]\n}\n\n// If the phone number being input is an international one\n// then tries to derive the country from the phone number.\n// (regardless of whether there's any country currently selected)\n/**\n * @param {string} parsedInput - A possibly incomplete E.164 phone number.\n * @param {string?} country - Currently selected country.\n * @param {string[]?} countries - A list of available countries. If not passed then \"all countries\" are assumed.\n * @param {boolean} includeInternationalOption - Whether \"International\" country option is available.\n * @param  {object} metadata - `libphonenumber-js` metadata.\n * @return {string?}\n */\nexport function getCountryForPartialE164Number\n(\n\tpartialE164Number,\n\tcountry,\n\tcountries,\n\tincludeInternationalOption,\n\tmetadata\n)\n{\n\tif (partialE164Number === '+')\n\t{\n\t\t// Don't change the currently selected country yet.\n\t\treturn country\n\t}\n\n\tconst derived_country = get_country_from_possibly_incomplete_international_phone_number(partialE164Number, metadata)\n\n\t// If a phone number is being input in international form\n\t// and the country can already be derived from it,\n\t// then select that country.\n\tif (derived_country && (!countries || (countries.indexOf(derived_country) >= 0)))\n\t{\n\t\treturn derived_country\n\t}\n\t// If \"International\" country option has not been disabled\n\t// and the international phone number entered doesn't correspond\n\t// to the currently selected country then reset the currently selected country.\n\telse if (country &&\n\t\tincludeInternationalOption &&\n\t\t!could_number_belong_to_country(partialE164Number, country, metadata))\n\t{\n\t\treturn undefined\n\t}\n\n\t// Don't change the currently selected country.\n\treturn country\n}\n\n/**\n * Parses `<input/>` value. Derives `country` from `input`. Derives an E.164 `value`.\n * @param  {string?} input — Parsed `<input/>` value. Examples: `\"\"`, `\"+\"`, `\"+123\"`, `\"123\"`.\n * @param  {string?} prevInput — Previous parsed `<input/>` value. Examples: `\"\"`, `\"+\"`, `\"+123\"`, `\"123\"`.\n * @param  {string?} country - Currently selected country.\n * @param  {string[]?} countries - A list of available countries. If not passed then \"all countries\" are assumed.\n * @param  {boolean} includeInternationalOption - Whether \"International\" country option is available.\n * @param  {boolean} limitMaxLength — Whether to enable limiting phone number max length.\n * @param  {object} metadata - `libphonenumber-js` metadata.\n * @return {object} An object of shape `{ input, country, value }`.\n */\nexport function parseInput(\n\tinput,\n\tprevInput,\n\tcountry,\n\tcountries,\n\tincludeInternationalOption,\n\tlimitMaxLength,\n\tmetadata\n) {\n\t// Trim the input to not exceed the maximum possible number length.\n\tif (input && country && limitMaxLength) {\n\t\tinput = trimNumber(input, country, metadata)\n\t}\n\n\t// If this `onChange()` event was triggered\n\t// as a result of selecting \"International\" country\n\t// then force-prepend a `+` sign if the phone number\n\t// `<input/>` value isn't in international format.\n\tif (input && !country && input[0] !== '+') {\n\t\tinput = '+' + input\n\t}\n\n\t// If the previously entered phone number\n\t// has been entered in international format\n\t// and the user decides to erase it,\n\t// then also reset the `country`\n\t// because it was most likely automatically selected\n\t// while the user was typing in the phone number\n\t// in international format.\n\t// This fixes the issue when a user is presented\n\t// with a phone number input with no country selected\n\t// and then types in their local phone number\n\t// then discovers that the input's messed up\n\t// (a `+` has been prepended at the start of their input\n\t//  and a random country has been selected),\n\t// decides to undo it all by erasing everything\n\t// and then types in their local phone number again\n\t// resulting in a seemingly correct phone number\n\t// but in reality that phone number has incorrect country.\n\t// https://github.com/catamphetamine/react-phone-number-input/issues/273\n\tif (!input && prevInput && prevInput[0] === '+') {\n\t\tcountry = undefined\n\t}\n\t// Also resets such \"randomly\" selected country\n\t// as soon as the user erases the number\n\t// digit-by-digit up to the leading `+` sign.\n\tif (input === '+' && prevInput && prevInput[0] === '+' && prevInput.length > '+'.length) {\n\t\tcountry = undefined\n\t}\n\n\t// Generate the new `value` property.\n\tlet value\n\tif (input) {\n\t\tif (input[0] === '+') {\n\t\t\tif (input !== '+') {\n\t\t\t\tvalue = input\n\t\t\t}\n\t\t} else {\n\t\t\tvalue = e164(input, country, metadata)\n\t\t}\n\t}\n\n\t// Derive the country from the phone number.\n\t// (regardless of whether there's any country currently selected)\n\tif (value) {\n\t\tcountry = getCountryForPartialE164Number(\n\t\t\tvalue,\n\t\t\tcountry,\n\t\t\tcountries,\n\t\t\tincludeInternationalOption,\n\t\t\tmetadata\n\t\t)\n\t}\n\n\treturn {\n\t\tinput,\n\t\tcountry,\n\t\tvalue\n\t}\n}\n\n/**\n * Determines the country for a given (possibly incomplete) E.164 phone number.\n * @param  {string} number - A possibly incomplete E.164 phone number.\n * @param  {object} metadata - `libphonenumber-js` metadata.\n * @return {string?}\n */\nexport function get_country_from_possibly_incomplete_international_phone_number(number, metadata)\n{\n\tconst formatter = new AsYouType(null, metadata)\n\tformatter.input(number)\n\t// `001` is a special \"non-geograpical entity\" code\n\t// in Google's `libphonenumber` library.\n\tif (formatter.country === '001') {\n\t\treturn\n\t}\n\treturn formatter.country\n}\n\n/**\n * Compares two strings.\n * A helper for `Array.sort()`.\n */\nexport function compare_strings(a, b) {\n  // Use `String.localeCompare` if it's available.\n  // https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare\n  // Which means everyone except IE <= 10 and Safari <= 10.\n  // `localeCompare()` is available in latest Node.js versions.\n  /* istanbul ignore else */\n  if (String.prototype.localeCompare) {\n    return a.localeCompare(b);\n  }\n  /* istanbul ignore next */\n  return a < b ? -1 : (a > b ? 1 : 0);\n}\n\n/**\n * Strips `+${countryCallingCode}` prefix from an E.164 phone number.\n * @param {string} number - (possibly incomplete) E.164 phone number.\n * @param {string?} country - A possible country for this phone number.\n * @param {object} metadata - `libphonenumber-js` metadata.\n * @return {string}\n */\nexport function strip_country_calling_code(number, country, metadata)\n{\n\t// Just an optimization, so that it\n\t// doesn't have to iterate through all country calling codes.\n\tif (country)\n\t{\n\t\tconst country_calling_prefix = '+' + getCountryCallingCode(country, metadata)\n\n\t\t// If `country` fits the actual `number`.\n\t\tif (number.length < country_calling_prefix.length)\n\t\t{\n\t\t\tif (country_calling_prefix.indexOf(number) === 0)\n\t\t\t{\n\t\t\t\treturn ''\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (number.indexOf(country_calling_prefix) === 0)\n\t\t\t{\n\t\t\t\treturn number.slice(country_calling_prefix.length)\n\t\t\t}\n\t\t}\n\t}\n\n\t// If `country` doesn't fit the actual `number`.\n\t// Try all available country calling codes.\n\tfor (const country_calling_code of Object.keys(metadata.country_calling_codes))\n\t{\n\t\tif (number.indexOf(country_calling_code) === '+'.length)\n\t\t{\n\t\t\treturn number.slice('+'.length + country_calling_code.length)\n\t\t}\n\t}\n\n\treturn ''\n}\n\n/**\n * Parses a partially entered national phone number digits\n * (or a partially entered E.164 international phone number)\n * and returns the national significant number part.\n * National significant number returned doesn't come with a national prefix.\n * @param {string} number - National number digits. Or possibly incomplete E.164 phone number.\n * @param {string?} country\n * @param {object} metadata - `libphonenumber-js` metadata.\n * @return {string} Can be empty.\n */\nexport function get_national_significant_number_part(number, country, metadata)\n{\n\t// Create \"as you type\" formatter.\n\tconst formatter = new AsYouType(country, metadata)\n\n\t// Input partial national phone number.\n\tformatter.input(number)\n\n\t// Return the parsed partial national phone number.\n\treturn formatter.getNationalNumber()\n}\n\n/**\n * Checks if a partially entered E.164 phone number could belong to a country.\n * @param  {string} number\n * @param  {string} country\n * @return {boolean}\n */\nexport function could_number_belong_to_country(number, country, metadata)\n{\n\tconst country_calling_code = getCountryCallingCode(country, metadata)\n\n\tlet i = 0\n\twhile (i + 1 < number.length && i < country_calling_code.length)\n\t{\n\t\tif (number[i + 1] !== country_calling_code[i])\n\t\t{\n\t\t\treturn false\n\t\t}\n\t\ti++\n\t}\n\n\treturn true\n}"]}